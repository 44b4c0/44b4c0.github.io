---
title: "Malware рЃљрЃюрЃљрЃџрЃўрЃќрЃў 'NativeApp_G4QLIQRa.exe' рЃюрЃљрЃгрЃўрЃџрЃў #1"
date: 2024-12-11 22:48:00 +0400
categories: [CyberSecurity,ReverseEngineering]
tags: [Malware]
---

## рЃЊрЃљрЃАрЃљрЃгрЃДрЃўрЃАрЃў

рЃЎрЃўрЃюрЃЮрЃА рЃЋрЃБрЃДрЃБрЃарЃћрЃЉрЃЊрЃў, рЃарЃЮрЃЊрЃћрЃАрЃљрЃф рЃарЃћрЃЎрЃџрЃљрЃЏрЃљрЃЏ рЃБрЃфрЃюрЃљрЃБрЃа рЃџрЃўрЃюрЃЎрЃќрЃћ рЃњрЃљрЃЊрЃљрЃЏрЃўрЃДрЃЋрЃљрЃюрЃљ, рЃАрЃљрЃўрЃЊрЃљрЃюрЃљрЃф `.exe` рЃцрЃљрЃўрЃџрЃўрЃА рЃњрЃљрЃЊрЃЏрЃЮрЃгрЃћрЃарЃљ рЃЊрЃљрЃўрЃгрЃДрЃЮ рЃЉрЃарЃљрЃБрЃќрЃћрЃарЃЏрЃљ. рЃћрЃА рЃљрЃЏрЃЉрЃљрЃЋрЃў рЃФрЃљрЃџрЃўрЃљрЃю рЃЏрЃћрЃБрЃфрЃюрЃљрЃБрЃарЃљ. рЃљрЃАрЃћ, рЃарЃЮрЃЏ рЃњрЃљрЃЏрЃЮрЃЋрЃарЃЌрЃћ рЃцрЃўрЃџрЃЏрЃў, рЃЕрЃљрЃЋрЃарЃЌрЃћ рЃЋрЃўрЃарЃбрЃБрЃљрЃџрЃБрЃарЃў рЃЏрЃљрЃюрЃЦрЃљрЃюрЃљ рЃЊрЃљ рЃћрЃА рЃцрЃљрЃўрЃџрЃў рЃўрЃЦ рЃњрЃљрЃЊрЃљрЃЋрЃўрЃбрЃљрЃюрЃћ.

рЃљрЃюрЃбрЃўрЃЋрЃўрЃарЃБрЃАрЃўрЃА рЃњрЃљрЃЏрЃЮрЃарЃЌрЃЋрЃљ рЃЏрЃЮрЃЏрЃўрЃгрЃўрЃљ, рЃарЃљрЃЊрЃњрЃљрЃю `Windows Defender`-рЃЏрЃљ рЃћрЃњрЃарЃћрЃЋрЃћ рЃЊрЃљрЃўрЃГрЃўрЃарЃљ рЃЋрЃўрЃарЃБрЃАрЃў.

## рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃА рЃЊрЃљрЃАрЃљрЃгрЃДрЃўрЃАрЃў

рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, рЃњрЃљрЃарЃЎрЃЋрЃћрЃБрЃџрЃў рЃ«рЃћрЃџрЃАрЃљрЃгрЃДрЃЮрЃћрЃЉрЃўрЃљ рЃАрЃљрЃГрЃўрЃарЃЮ рЃљрЃЏ рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃАрЃљрЃЌрЃЋрЃўрЃА. рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃЮрЃа рЃърЃарЃЮрЃњрЃарЃљрЃЏрЃљрЃА рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ:

1. radare2
2. xdbg

`xdbg` рЃБрЃцрЃарЃЮ рЃЊрЃўрЃюрЃљрЃЏрЃўрЃБрЃарЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃАрЃљрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ, рЃ«рЃЮрЃџрЃЮ `radare2`-рЃА рЃЮрЃарЃўрЃЋрЃћ рЃАрЃљрЃ«рЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃерЃћрЃБрЃФрЃџрЃўрЃљ, рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃарЃўрЃф рЃЊрЃљ рЃЊрЃўрЃюрЃљрЃЏрЃўрЃБрЃарЃўрЃф. рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, `xdbg`-рЃАрЃљрЃф рЃерЃћрЃБрЃФрЃџрЃўрЃљ рЃўрЃњрЃўрЃЋрЃћрЃА рЃњрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃљ, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃЏ рЃЮрЃа рЃърЃарЃЮрЃњрЃарЃљрЃЏрЃљрЃА рЃерЃЮрЃарЃўрЃА рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃЊрЃўрЃЊрЃў рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃљрЃљ рЃЊрЃљ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃќрЃЮрЃњрЃў рЃарЃљрЃЏ рЃАрЃ«рЃЋрЃљрЃюрЃљрЃўрЃарЃљрЃЊ рЃњрЃљрЃЏрЃЮрЃЕрЃюрЃЊрЃћрЃА.

#### radare2

рЃърЃўрЃарЃЋрЃћрЃџ рЃарЃўрЃњрЃерЃў, рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃарЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃЮ. рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃљ рЃљрЃАрЃћрЃЌрЃў рЃўрЃЦрЃюрЃћрЃЉрЃљ:

```powershell
.\r2.exe NativeApp_G4QLIQRa.exe
```

рЃљрЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ, `r2` рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃерЃў рЃЊрЃљрЃЏрЃћрЃ«рЃЏрЃљрЃарЃћрЃЉрЃљ:

```powershell
[0x004033bf]>
```

рЃћрЃА рЃърЃарЃЮрЃЏрЃърЃбрЃў(Prompt) рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃЌрЃБ рЃарЃЮрЃЏрЃћрЃџ `Memory Address`-рЃА рЃБрЃДрЃБрЃарЃћрЃЉрЃА `r2`. рЃЌрЃљрЃЋрЃЊрЃљрЃърЃўрЃарЃЋрЃћрЃџрЃљрЃЊ, рЃАрЃљрЃГрЃўрЃарЃЮрЃљ рЃљрЃЏ рЃцрЃљрЃўрЃџрЃўрЃА рЃАрЃарЃБрЃџрЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў:

```powershell
aaaa
```

рЃљрЃЏ рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃўрЃЌ `r2` рЃАрЃарЃБрЃџрЃљрЃЊ рЃњрЃљрЃљрЃљрЃюрЃљрЃџрЃўрЃќрЃћрЃЉрЃА рЃцрЃљрЃўрЃџрЃА. рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃљрЃЊ рЃЏрЃћрЃфрЃЮрЃЊрЃўрЃюрЃћрЃЉрЃљ рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџрЃљрЃЊ рЃарЃљ рЃ«рЃЊрЃћрЃЉрЃљ рЃцрЃљрЃўрЃџрЃерЃў:

1. рЃўрЃЏрЃърЃЮрЃарЃбрЃћрЃЉрЃў(Imports)
2. рЃћрЃЦрЃАрЃърЃЮрЃарЃбрЃћрЃЉрЃў(Exports)
3. рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮрЃћрЃЉрЃў рЃЊрЃљ рЃбрЃћрЃЦрЃАрЃбрЃћрЃЉрЃў(Symbols and Strings)
4. рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў(Functions)

рЃљрЃюрЃБ, рЃарЃљ рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮрЃћрЃЉрЃў, рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃћрЃЉрЃў рЃЊрЃљ рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃўрЃљ рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў. рЃљрЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ, рЃерЃћрЃЏрЃўрЃФрЃџрЃўрЃљ `afl` рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ, рЃарЃљрЃЌрЃљ рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃбрЃљрЃюрЃЮ рЃбрЃћрЃарЃЏрЃўрЃюрЃљрЃџрЃерЃў:

![1.png](https://44b4c0.github.io/assets/img/posts/18/1.png)

рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, рЃЎрЃўрЃЊрЃћрЃЋ рЃЉрЃћрЃЋрЃарЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃљ, рЃБрЃЉрЃарЃљрЃџрЃЮрЃЊ рЃћрЃарЃЌ рЃцрЃЮрЃбрЃЮрЃерЃў рЃЋрЃћрЃа рЃЋрЃљрЃбрЃћрЃЋ. рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, рЃАрЃљрЃГрЃўрЃарЃЮрЃљ `entry0`-рЃќрЃћ рЃњрЃљрЃЊрЃљрЃАрЃЋрЃџрЃљ, рЃарЃљрЃЊрЃњрЃљрЃю рЃАрЃгрЃЮрЃарЃћрЃЊ рЃћрЃАрЃљрЃљ рЃърЃарЃЮрЃњрЃарЃљрЃЏрЃўрЃА рЃћ.рЃг. `Entry Point`.

```powershell
s entry0
```

рЃАрЃгрЃЮрЃарЃћрЃЊ рЃљрЃЏ рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃўрЃЌ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ `entry0`-рЃќрЃћ рЃњрЃљрЃЊрЃљрЃАрЃЋрЃџрЃљ. рЃљрЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ, `v` рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃўрЃЌ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃњрЃарЃљрЃцрЃўрЃЎрЃБрЃџрЃў рЃўрЃюрЃбрЃћрЃарЃцрЃћрЃўрЃАрЃўрЃА рЃЕрЃљрЃарЃЌрЃЋрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃюрЃљрЃњрЃБрЃџрЃўрЃАрЃ«рЃЏрЃћрЃЋрЃљрЃЊ(By default) рЃЊрЃўрЃАрЃљрЃАрЃћрЃЏрЃЉрЃџрЃўрЃА, рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮрЃћрЃЉрЃўрЃА рЃАрЃўрЃљрЃА рЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃАрЃўрЃљрЃА рЃњрЃљрЃЏрЃЮрЃўрЃбрЃљрЃюрЃА:

![2.png](https://44b4c0.github.io/assets/img/posts/18/2.png)

рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃАрЃўрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃАрЃљрЃА, рЃЕрЃљрЃюрЃА, рЃарЃЮрЃЏ рЃФрЃљрЃџрЃўрЃљрЃю рЃЉрЃћрЃЋрЃарЃў `Win32API` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃљ рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў. рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ:

1. CreateThread
2. CreateDirectoryW
3. CreateProcessW
4. GetProcAddress

#### рЃарЃљрЃбрЃЮрЃЏ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃўрЃЦрЃЏрЃюрЃћрЃЉрЃЮрЃЊрЃћрЃА рЃгрЃарЃћрЃЊрЃў?

рЃљрЃарЃўрЃА рЃЮрЃарЃў рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў. **рЃърЃўрЃарЃЋрЃћрЃџрЃў рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў** рЃљрЃарЃўрЃА рЃўрЃА, рЃарЃЮрЃЏ рЃћрЃА рЃгрЃарЃћрЃЊрЃў рЃБрЃДрЃБрЃарЃћрЃЉрЃА рЃЊрЃћрЃЉрЃљрЃњрЃћрЃарЃА(рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў `r2` рЃљрЃю `xdbg` рЃЊрЃљ рЃЏрЃўрЃАрЃў рЃњрЃљрЃЏрЃЮрЃЕрЃћрЃюрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃърЃарЃЮрЃњрЃарЃљрЃЏрЃљрЃА рЃљрЃю рЃњрЃљрЃЌрЃерЃљрЃЋрЃА рЃљрЃю рЃАрЃљрЃћрЃарЃЌрЃЮрЃЊ рЃАрЃ«рЃЋрЃљ рЃарЃљрЃЏрЃћрЃА рЃњрЃљрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃўрЃюрЃћрЃЉрЃА. **рЃЏрЃћрЃЮрЃарЃћ рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў** рЃгрЃарЃћрЃЊрЃерЃў рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃўрЃДрЃЮрЃА рЃЏрЃљрЃЋрЃюрЃћ рЃЌрЃЋрЃўрЃАрЃћрЃЉрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЏрЃЌрЃљрЃЋрЃљрЃа рЃЏрЃљрЃЋрЃюрЃћ рЃЌрЃЋрЃўрЃАрЃћрЃЉрЃљрЃАрЃЌрЃљрЃю рЃћрЃарЃЌрЃљрЃЊ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃЕрЃюрЃЊрЃћрЃА.

#### рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃЌрЃљрЃю рЃЏрЃЮрЃЏрЃБрЃерЃљрЃЋрЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў

рЃљрЃАрЃћрЃЋрЃћ рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃюрЃћ рЃўрЃАрЃћрЃЌрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў, рЃарЃЮрЃЏрЃџрЃћрЃЉрЃўрЃф рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃўрЃА рЃерЃћрЃфрЃЋрЃџрЃљрЃА рЃфрЃЊрЃўрЃџрЃЮрЃЉрЃћрЃю:

1. RegDeleteKeyW
2. RegDeleteValueW
3. RegEnumKeyW
4. RegCloseKey
5. RegSetValueExW
6. RegQueryValueExW

**рЃарЃљрЃбрЃЮрЃЏ рЃфрЃЋрЃџрЃўрЃА рЃЏрЃљрЃЋрЃюрЃћ рЃЎрЃЮрЃЊрЃў рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃА?**. рЃљрЃЦрЃљрЃф рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃА рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў. рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ, рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃЏрЃљрЃЋрЃюрЃћ рЃЎрЃЮрЃЊрЃў рЃарЃЮрЃЏрЃћрЃџрЃўрЃдрЃљрЃф рЃЊрЃљрЃЏрЃљрЃџрЃБрЃџ рЃцрЃљрЃўрЃџрЃерЃў рЃЏрЃљрЃџрЃљрЃЋрЃА рЃўрЃЏрЃърЃџрЃљрЃюрЃбрЃА рЃЊрЃљ рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃерЃў рЃљрЃЏрЃљрЃбрЃћрЃЉрЃА рЃЏрЃўрЃАрЃў рЃњрЃљрЃерЃЋрЃћрЃЉрЃўрЃА рЃЉрЃарЃФрЃљрЃюрЃћрЃЉрЃљрЃА. рЃарЃЮрЃЊрЃћрЃАрЃљрЃф рЃЎрЃЮрЃЏрЃърЃўрЃБрЃбрЃћрЃарЃў рЃЕрЃљрЃўрЃарЃЌрЃЋрЃћрЃЉрЃљ, рЃЏрЃљрЃЋрЃюрЃћ рЃЎрЃЮрЃЊрЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃњрЃљрЃћрЃерЃЋрЃћрЃЉрЃљ рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃўрЃЊрЃљрЃю.

## рЃАрЃћрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў

рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃћрЃбрЃљрЃЊ рЃўрЃЏ рЃцрЃљрЃЦрЃбрЃЏрЃљ рЃЊрЃљрЃЏрЃљрЃћрЃГрЃЋрЃљ, рЃарЃЮрЃЏ рЃцрЃљрЃўрЃџрЃў рЃљрЃарЃўрЃА `50MB` рЃќрЃЮрЃЏрЃљрЃерЃў. рЃћрЃА рЃЉрЃћрЃЋрЃа рЃарЃљрЃЏрЃћрЃА рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃюрЃўрЃерЃюрЃљрЃЋрЃЊрЃћрЃА.

1. рЃЌрЃљрЃЋрЃЊрЃљрЃЏрЃАрЃ«рЃЏрЃћрЃџрЃЏрЃљ рЃЊрЃўрЃЊрЃў `payload` рЃЏрЃЮрЃљрЃЌрЃљрЃЋрЃАрЃљ рЃарЃЮрЃЏрЃћрЃџрЃўрЃЏрЃћ рЃАрЃћрЃЦрЃфрЃўрЃљрЃерЃў, рЃарЃЮрЃЏрЃћрЃџрЃАрЃљрЃф рЃњрЃљрЃерЃЋрЃћрЃЉрЃўрЃА рЃЊрЃарЃЮрЃА рЃ«рЃАрЃюрЃўрЃА рЃЊрЃљ рЃАрЃљрЃЏрЃўрЃќрЃюрЃћ рЃцрЃљрЃўрЃџрЃерЃў рЃљрЃЌрЃљрЃЋрЃАрЃћрЃЉрЃА.

рЃгрЃўрЃюрЃљрЃќрЃћ рЃарЃЮрЃЏ рЃЋрЃЌрЃЦрЃЋрЃў рЃарЃћрЃњрЃўрЃАрЃбрЃарЃћрЃЉрЃА рЃфрЃЋрЃџрЃўрЃА рЃЊрЃљ рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ рЃцрЃљрЃўрЃџрЃА рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃБрЃерЃЋрЃћрЃЉрЃА-рЃЏрЃћрЃЌрЃЦрЃў, рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ рЃАрЃгрЃЮрЃарЃћрЃЊ рЃћрЃњ рЃцрЃљрЃўрЃџрЃўрЃљ рЃЕрЃљрЃЊрЃћрЃЉрЃБрЃџрЃў, рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ `.text` рЃАрЃћрЃЦрЃфрЃўрЃљрЃерЃў рЃЊрЃљ рЃўрЃЦрЃўрЃЊрЃљрЃю рЃ«рЃЊрЃћрЃЉрЃљ рЃљрЃЏ рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃЏрЃЮрЃдрЃћрЃЉрЃљ рЃЊрЃљ рЃАрЃљрЃЊрЃЏрЃћ рЃерЃћрЃюрЃљрЃ«рЃЋрЃљ.

рЃљрЃЏрЃўрЃА рЃњрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃљ рЃФрЃљрЃџрЃўрЃљрЃю рЃЏрЃљрЃарЃбрЃўрЃЋрЃўрЃљ. рЃќрЃЮрЃњрЃљрЃЊрЃљрЃЊ, рЃљрЃАрЃћрЃЌ рЃцрЃљрЃўрЃџрЃћрЃЉрЃА рЃЏрЃљрЃбрЃарЃўрЃЮрЃерЃЎрЃћрЃЉрЃА рЃЋрЃћрЃФрЃљрЃ«рЃў, рЃарЃљрЃЊрЃњрЃљрЃю рЃАрЃгрЃЮрЃарЃћрЃЊ рЃЏрЃљрЃбрЃарЃўрЃЮрЃерЃЎрЃљрЃА рЃърЃарЃўрЃюрЃфрЃўрЃърЃўрЃЌ рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА рЃљрЃАрЃћрЃЌрЃў рЃцрЃљрЃўрЃџрЃћрЃЉрЃў.

> **­ЪЊ░ рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮ рЃцрЃљрЃЦрЃбрЃў:**
> 
> рЃћ.рЃг. "рЃЏрЃљрЃбрЃарЃўрЃЮрЃерЃЎрЃљ" рЃљрЃарЃўрЃА рЃарЃБрЃАрЃБрЃџрЃў рЃАрЃљрЃЌрЃљрЃЏрЃљрЃерЃЮ. рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃўрЃљ рЃ«рЃБрЃЌрЃў рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃќрЃЮрЃЏрЃўрЃА рЃћрЃарЃЌрЃюрЃљрЃўрЃарЃў рЃцрЃўрЃњрЃБрЃарЃљ рЃЊрЃљ рЃўрЃАрЃўрЃюрЃў рЃћрЃарЃЌрЃЏрЃљрЃюрЃћрЃЌрЃерЃў рЃџрЃљрЃњрЃЊрЃћрЃЉрЃўрЃљрЃю. рЃАрЃгрЃЮрЃарЃћрЃЊ рЃљрЃАрЃћрЃЌрЃў рЃърЃарЃўрЃюрЃфрЃўрЃърЃў рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃ░рЃЦрЃЮрЃюрЃЊрЃћрЃА рЃЋрЃўрЃарЃБрЃАрЃА. рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃўрЃЏрЃърЃџрЃљрЃюрЃбрЃў рЃЊрЃарЃЮрЃърЃћрЃарЃерЃўрЃЋрЃћ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃўрЃДрЃЮрЃА рЃЊрЃљрЃћрЃюрЃЎрЃЮрЃЊрЃћрЃЉрЃБрЃџрЃў/рЃЊрЃљрЃерЃўрЃцрЃарЃБрЃџрЃў.

```
Dropper                                   Extracted Mutant as a file 
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ     РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ                                   Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓMutant            Mutant Extractor Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ   РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћѓxxxxxxxxxxxxxРћѓ   Рћѓ              РћюРћђРћ╝РћђРћђРћђРћђРќ║РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћѓxxxxxxxxxxxxxРћѓ   РћћРћђРћђРћђРћђРћђРћђРќ▓РћђРћђРћђРћђРћђРћђРћђРћў Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћѓxxxxxxxxxxxxxРћѓ   РћїРћђРћђРћђРћђРћђРћђРћ┤РћђРћђРћђРћђРћђРћђРћђРћљ Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћѓxxxxxxxxxxxxxРћ╝РћђРћђРћђРќ║              Рћѓ Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћѓРћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў   РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў Рћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
Рћѓ                  Decoder/DecryptorРћѓ     РћѓxxxxxxxxxxxxxxxxxxxxxxxxxРћѓ
РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў     РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
```

рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃБрЃцрЃарЃЮ рЃЏрЃћрЃбрЃў рЃарЃљрЃдрЃљрЃфрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃљ рЃЊрЃарЃЮрЃърЃћрЃарЃерЃў рЃЊрЃљ рЃќрЃЮрЃњрЃљрЃЊрЃљрЃЊ рЃћрЃА рЃљрЃАрЃћрЃфрЃљрЃљ рЃ«рЃЮрЃџрЃЏрЃћ, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃАрЃўрЃЏрЃљрЃарЃбрЃўрЃЋрЃўрЃАрЃЌрЃЋрЃўрЃА рЃљрЃдрЃљрЃа рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћ рЃњрЃарЃљрЃцрЃљрЃерЃў рЃЋрЃўрЃарЃБрЃАрЃўрЃА рЃерЃћрЃАрЃљрЃФрЃџрЃЮ рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃБрЃюрЃљрЃа-рЃЕрЃЋрЃћрЃЋрЃћрЃЉрЃў.

рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, "рЃЏрЃљрЃбрЃарЃўрЃЮрЃерЃЎрЃљрЃА" `рЃЏрЃБрЃбрЃљрЃюрЃбрЃў` рЃЊрЃљ `рЃЊрЃарЃЮрЃърЃћрЃарЃў` рЃњрЃљрЃюрЃљрЃАрЃљрЃ«рЃўрЃћрЃарЃћрЃЉрЃћрЃю.

2. рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ Malware рЃЊрЃћрЃЋрЃћрЃџрЃЮрЃърЃћрЃарЃЏрЃљ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃўрЃЌрЃЮрЃЉрЃўрЃА рЃърЃарЃўрЃюрЃфрЃўрЃърЃўрЃЌ рЃерЃћрЃбрЃћрЃюрЃљ рЃцрЃљрЃўрЃџрЃА рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃерЃў рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃцрЃљрЃўрЃџрЃћрЃЉрЃў рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃўрЃЏрЃўрЃбрЃЮрЃЏ, рЃарЃЮрЃЏ рЃљрЃюрЃбрЃўрЃЋрЃўрЃарЃБрЃАрЃА рЃЏрЃўрЃАрЃў рЃАрЃбрЃљрЃбрЃўрЃЎрЃБрЃарЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃЋрЃћрЃа рЃерЃћрЃФрЃџрЃћрЃЉрЃЮрЃЊрЃљ.

рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ, `NTFS` рЃцрЃљрЃўрЃџрЃБрЃа рЃАрЃўрЃАрЃбрЃћрЃЏрЃљрЃерЃў(File System) рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃћ.рЃг. `Data Stream`-рЃўрЃА рЃЦрЃЮрЃюрЃљ. рЃљрЃЦрЃћрЃЊрЃљрЃю рЃњрЃљрЃЏрЃЮрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ, рЃЏрЃћрЃЮрЃарЃћ рЃюрЃљрЃЎрЃљрЃЊрЃерЃў рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃЏрЃБрЃбрЃљрЃюрЃбрЃўрЃА/рЃўрЃЏрЃърЃџрЃљрЃюрЃбрЃўрЃА рЃЕрЃљрЃЊрЃњрЃЏрЃљ рЃљрЃю рЃЌрЃБрЃюрЃЊрЃљрЃф рЃљрЃЏ рЃюрЃљрЃЎрЃљрЃЊрЃћрЃЉрЃўрЃА рЃБрЃљрЃќрЃарЃЮ рЃцрЃљрЃўрЃџрЃћрЃЉрЃўрЃЌ рЃљрЃЏрЃЮрЃЋрЃАрЃћрЃЉрЃљ, рЃарЃљрЃЌрЃљ рЃљрЃюрЃбрЃўрЃЋрЃўрЃарЃБрЃАрЃА рЃљрЃЏ рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџрЃў рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃњрЃљрЃБрЃГрЃўрЃарЃЊрЃћрЃА.

рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ, рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃА `main` рЃюрЃљрЃЎрЃљрЃЊрЃў, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЌрЃЋрЃўрЃЌрЃЮрЃю рЃцрЃљрЃўрЃџрЃА рЃерЃћрЃўрЃфрЃљрЃЋрЃА. рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃАрЃћрЃЋрЃћ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃАрЃ«рЃЋрЃљ рЃюрЃљрЃЎрЃљрЃЊрЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃЌрЃљ рЃЊрЃљрЃюрЃљрЃ«рЃЋрЃљ рЃФрЃљрЃџрЃўрЃљрЃю рЃарЃЌрЃБрЃџрЃў рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃўрЃДрЃЮрЃА рЃЊрЃљ рЃЊрЃљрЃЏрЃгрЃДрЃћрЃЉ "рЃарЃћрЃЋрЃћрЃарЃА рЃўрЃюрЃЪрЃўрЃюрЃћрЃарЃА"/"Malware рЃљрЃюрЃљрЃџрЃўрЃбрЃўрЃЎрЃЮрЃАрЃА" рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ рЃњрЃљрЃЏрЃЮрЃарЃЕрЃћрЃА рЃЎрЃўрЃЊрЃћрЃф рЃЏрЃљрЃЌрЃерЃў рЃЏрЃЮрЃЌрЃљрЃЋрЃАрЃћрЃЉрЃБрЃџрЃў рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў(рЃцрЃљрЃўрЃџрЃћрЃЉрЃў).

![3.png](https://44b4c0.github.io/assets/img/posts/18/3.png)

рЃљрЃЦ рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃўрЃљ рЃАрЃћрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃќрЃЮрЃЏрЃћрЃЉрЃў. рЃарЃЮрЃњрЃЮрЃарЃф рЃЕрЃљрЃюрЃА, `.text` рЃАрЃћрЃЦрЃфрЃўрЃљ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊрЃўрЃљ. рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃАрЃћрЃЋрЃћ рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃЊрЃўрЃЊрЃўрЃљ `.rdata` рЃЊрЃљ `.rsrc` рЃАрЃћрЃЦрЃфрЃўрЃћрЃЉрЃў. `.rsrc` рЃАрЃћрЃЦрЃфрЃўрЃљ рЃќрЃЮрЃњрЃљрЃЊрЃљрЃЊ рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌ рЃарЃћрЃАрЃБрЃарЃАрЃћрЃЉрЃА рЃерЃћрЃўрЃфрЃљрЃЋрЃА, рЃарЃЮрЃњрЃЮрЃарЃўрЃф рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃўрЃДрЃЮрЃА `icon` рЃљрЃю рЃарЃљрЃЏрЃћ рЃЏрЃАрЃњрЃљрЃЋрЃАрЃў. рЃўрЃЊрЃћрЃљрЃерЃў, рЃюрЃћрЃЉрЃўрЃАрЃЏрЃўрЃћрЃарЃў рЃарЃљрЃЏрЃўрЃА рЃЏрЃЮрЃЌрЃљрЃЋрЃАрЃћрЃЉрЃљ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃљрЃЏ рЃАрЃћрЃЦрЃфрЃўрЃљрЃерЃў, рЃўрЃАрЃћрЃЋрЃћ рЃарЃЮрЃњрЃЮрЃарЃф рЃДрЃЋрЃћрЃџрЃљ рЃАрЃ«рЃЋрЃљ рЃАрЃћрЃЦрЃфрЃўрЃљрЃерЃў. `.rdata` рЃАрЃћрЃЦрЃфрЃўрЃљ рЃљрЃарЃўрЃА `read-only data`,  рЃАрЃљрЃЊрЃљрЃф рЃљрЃАрЃћрЃЋрЃћ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃЏрЃЮрЃЌрЃљрЃЋрЃАрЃЊрЃћрЃА рЃўрЃЏрЃърЃџрЃљрЃюрЃбрЃў. рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃў рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃЏрЃўрЃАрЃў рЃЉрЃљрЃўрЃбрЃћрЃЉрЃўрЃА рЃљрЃЏрЃЮрЃЎрЃўрЃЌрЃ«рЃЋрЃљ рЃЊрЃљ рЃАрЃ«рЃЋрЃљ рЃцрЃљрЃўрЃџрЃерЃў рЃЕрЃљрЃгрЃћрЃарЃљ.

рЃЌрЃЋрЃўрЃЌрЃЮрЃю `.text` рЃАрЃћрЃЦрЃфрЃўрЃљ `ASM` рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃћрЃЉрЃА рЃерЃћрЃўрЃфрЃљрЃЋрЃА.

![4.png](https://44b4c0.github.io/assets/img/posts/18/4.png)

рЃћрЃА рЃбрЃћрЃЦрЃАрЃбрЃў рЃЏрЃљрЃћрЃГрЃЋрЃћрЃЉрЃА, рЃарЃЮрЃЏ рЃЋрЃўрЃарЃБрЃАрЃў рЃЦрЃАрЃћрЃџрЃерЃў рЃњрЃљрЃЊрЃўрЃА. рЃўрЃЏрЃўрЃбрЃЮрЃЏ, рЃарЃЮрЃЏ `SSL` рЃ«рЃерЃўрЃарЃљрЃЊрЃљрЃљ рЃюрЃљрЃ«рЃАрЃћрЃюрЃћрЃЉрЃў. `SSL`(Secure Socket Layer) рЃЎрЃљрЃЋрЃерЃўрЃарЃўрЃА рЃерЃўрЃцрЃарЃљрЃфрЃўрЃўрЃАрЃљрЃЌрЃЋрЃўрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ.

рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ, рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ `OpenSSL` рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃўрЃЌ рЃАрЃЮрЃЎрЃћрЃбрЃќрЃћ `SSL` рЃбрЃБрЃюрЃћрЃџрЃўрЃА рЃњрЃљрЃбрЃљрЃарЃћрЃЉрЃљ, рЃарЃљрЃф рЃАрЃЮрЃЎрЃћрЃбрЃќрЃћ рЃњрЃљрЃЏрЃљрЃЋрЃљрЃџ рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљрЃА рЃЊрЃљрЃерЃўрЃцрЃарЃљрЃЋрЃА. рЃгрЃћрЃАрЃўрЃЌ, рЃљрЃЏрЃљрЃю рЃАрЃљрЃЦрЃЏрЃћ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃљрЃарЃЌрЃБрЃџрЃЮрЃА рЃўрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃЌрЃБ `SSL` рЃАрЃћрЃарЃбрЃўрЃцрЃўрЃЎрЃљрЃбрЃў рЃЋрЃўрЃарЃБрЃАрЃерЃўрЃЋрЃћ рЃљрЃарЃљрЃљ рЃЕрЃљрЃЦрЃАрЃЮрЃЋрЃўрЃџрЃў. рЃгрЃўрЃюрЃљрЃљрЃдрЃЏрЃЊрЃћрЃњ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, рЃАрЃћрЃарЃбрЃўрЃцрЃўрЃЎрЃљрЃбрЃўрЃЌрЃЋрЃћ рЃњрЃљрЃЋрЃерЃўрЃцрЃарЃљрЃЋ рЃбрЃарЃљрЃцрЃўрЃЎрЃА рЃЊрЃўрЃюрЃљрЃЏрЃўрЃБрЃарЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃўрЃА рЃЊрЃарЃЮрЃА.

## Assembly рЃўрЃфрЃў???

рЃЎрЃў, рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ рЃЋрЃўрЃфрЃў. рЃћрЃА рЃЏрЃљрЃФрЃџрЃћрЃЋрЃА рЃўрЃЏрЃўрЃА рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃџрЃЮрЃЉрЃљрЃА, рЃарЃЮрЃЏ рЃЎрЃљрЃарЃњрЃў Malware рЃЊрЃљрЃЋрЃгрЃћрЃарЃЮ рЃЊрЃљ рЃАрЃ«рЃЋрЃўрЃАрЃў рЃЊрЃљрЃгрЃћрЃарЃўрЃџрЃў рЃюрЃћрЃЉрЃўрЃАрЃЏрЃўрЃћрЃарЃў рЃЎрЃЮрЃЊрЃў рЃњрЃљрЃЋрЃљрЃљрЃюрЃљрЃџрЃўрЃќрЃЮ рЃЎрЃўрЃЊрЃћрЃф.

![5.png](https://44b4c0.github.io/assets/img/posts/18/5.png)

рЃљрЃЏ рЃАрЃБрЃарЃљрЃЌрЃерЃў рЃЋрЃ«рЃћрЃЊрЃљрЃЋрЃЌ, рЃарЃЮрЃЏ `ESP` рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃА рЃњрЃљрЃЏрЃЮрЃљрЃЎрЃџрЃЊрЃљ `0x2d4`, рЃарЃљрЃЌрЃљ рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃў рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃўрЃАрЃљрЃЌрЃЋрЃўрЃА рЃњрЃљрЃЏрЃЮрЃўрЃДрЃЮрЃА рЃљрЃЊрЃњрЃўрЃџрЃў рЃАрЃбрЃљрЃЎрЃќрЃћ. рЃерЃћрЃЏрЃЊрЃћрЃњ, рЃАрЃбрЃљрЃЎрЃќрЃћ рЃерЃћрЃњрЃЋрЃљрЃЦрЃЋрЃА `ebx`, `esi`, `edi` рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃћрЃЉрЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ `0x20`. рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, `ebx` рЃЊрЃљрЃўрЃЎрЃљрЃЋрЃћрЃЉрЃА `arg2`-рЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљрЃА. рЃћрЃА `arg2` рЃљрЃЏ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃА рЃЊрЃћрЃЎрЃџрЃљрЃарЃљрЃфрЃўрЃљрЃерЃўрЃЋрЃћ рЃљрЃЦрЃЋрЃА рЃњрЃљрЃгрЃћрЃарЃўрЃџрЃў:

```C++
int32_t arg1, int32_t arg2
```

рЃърЃўрЃарЃЋрЃћрЃџ рЃљрЃарЃњрЃБрЃЏрЃћрЃюрЃбрЃА `eax` рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃў рЃерЃћрЃўрЃюрЃљрЃ«рЃљрЃЋрЃА, рЃ«рЃЮрЃџрЃЮ рЃЏрЃћрЃЮрЃарЃћрЃА `ebx`. рЃћрЃА рЃўрЃЦрЃўрЃЊрЃљрЃю рЃњрЃљрЃЏрЃЮрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ, рЃарЃЮрЃЏ `General Purpose` рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃћрЃЉрЃў рЃљрЃАрЃћ рЃўрЃгрЃДрЃЮрЃЉрЃљ:

1. ax
2. bx
3. cx
4. dx

рЃ«рЃЮрЃџрЃЮ рЃўрЃЏрЃўрЃА рЃњрЃљрЃЏрЃЮ, рЃарЃЮрЃЏ 16 рЃЉрЃўрЃбрЃўрЃљрЃюрЃў рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃЊрЃљрЃю рЃАрЃљрЃќрЃЮрЃњрЃљрЃЊрЃЮрЃћрЃЉрЃљ рЃ»рЃћрЃа 32, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЎрЃў 64 рЃЉрЃўрЃбрЃўрЃљрЃю рЃАрЃўрЃАрЃбрЃћрЃЏрЃћрЃЉрЃќрЃћ рЃњрЃљрЃЊрЃљрЃЋрЃўрЃЊрЃљ, рЃерЃћрЃўрЃфрЃЋрЃљрЃџрЃљ рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃћрЃЉрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃћрЃЉрЃўрЃф:

1. eax
2. ebx
3. ecx
4. edx

рЃћрЃА, рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, 32 рЃЉрЃўрЃбрЃўрЃљрЃю рЃАрЃўрЃАрЃбрЃћрЃЏрЃћрЃЉрЃќрЃћ.

рЃљрЃЏ рЃцрЃЮрЃбрЃЮрЃерЃў рЃбрЃћрЃЦрЃАрЃбрЃўрЃфрЃљрЃљ рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃў: `Error writing temporary file. Make sure your temp folder is valid.`

рЃарЃЮрЃЊрЃћрЃАрЃљрЃф `KERNEL32.dll` рЃцрЃљрЃўрЃџрЃўрЃЊрЃљрЃю `SetErrorMode` рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃЏрЃЮрЃарЃЕрЃћрЃЉрЃљ, рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃЏрЃћрЃЮрЃарЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃўрЃгрЃДрЃћрЃЉрЃА рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃљрЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃарЃўрЃА `GetVerson`.

рЃћрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃБрЃфрЃюрЃљрЃБрЃарЃўрЃљ рЃЊрЃљ рЃДрЃБрЃарЃљрЃЊрЃдрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃљрЃ«рЃЋрЃўрЃџрЃћрЃЉрЃљрЃљ рЃАрЃљрЃГрЃўрЃарЃЮ. `GetVersion();` рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА `DWORD`-рЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃюрЃўрЃерЃюрЃљрЃЋрЃА `Double Word`-рЃА. рЃћрЃА рЃљрЃарЃўрЃА 32 рЃЉрЃљрЃўрЃбрЃў.

рЃцрЃЮрЃарЃЏрЃљрЃбрЃў рЃљрЃарЃўрЃА рЃљрЃАрЃћрЃЌрЃў:

```cpp
0x00000000
```

рЃърЃўрЃарЃЋрЃћрЃџрЃў 4 рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮ рЃгрЃљрЃарЃЏрЃЮрЃљрЃЊрЃњрЃћрЃюрЃА рЃћ.рЃг. `Build number`-рЃА. рЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЮрЃарЃў рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮ рЃгрЃљрЃарЃЏрЃЮрЃљрЃЊрЃњрЃћрЃюрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЏрЃўрЃюрЃЮрЃарЃБрЃџ рЃЋрЃћрЃарЃАрЃўрЃљрЃА, рЃ«рЃЮрЃџрЃЮ рЃЉрЃЮрЃџрЃЮ рЃЮрЃарЃў рЃАрЃўрЃЏрЃЉрЃЮрЃџрЃЮ рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЏрЃљрЃЪрЃЮрЃарЃБрЃџ рЃЋрЃћрЃарЃАрЃўрЃљрЃА. рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ:

```
Windows Version: 10.0 (Build 19045)
```

рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў, рЃЏрЃљрЃЪрЃЮрЃарЃБрЃџрЃў рЃЋрЃћрЃарЃАрЃўрЃљрЃљ `10`, рЃЏрЃўрЃюрЃЮрЃарЃБрЃџрЃў рЃЋрЃћрЃарЃАрЃўрЃљрЃљ `0`, рЃ«рЃЮрЃџрЃЮ `Build Number` рЃљрЃарЃўрЃА `19045`.

![6.png](https://44b4c0.github.io/assets/img/posts/18/6.png)

рЃљрЃЦ рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃўрЃљ рЃћрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃљ:

```asm
and eax,0xbfffffff
```

рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃърЃўрЃарЃЋрЃћрЃџ рЃљрЃарЃњрЃБрЃЏрЃћрЃюрЃбрЃАрЃљ рЃЊрЃљ `0xbfffffff` рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљрЃА рЃерЃЮрЃарЃўрЃА рЃЕрЃљрЃљрЃбрЃљрЃарЃћрЃЉрЃА `and` рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃљрЃА. рЃћрЃА рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃарЃљрЃдрЃљрЃфрЃўрЃА рЃњрЃљрЃЏрЃЮ рЃЏрЃЮрЃ«рЃЊрЃћрЃА. рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ рЃЊрЃћрЃЋрЃћрЃџрЃЮрЃърЃћрЃарЃА `eax`-рЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљрЃерЃў рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџрЃў рЃЉрЃўрЃбрЃћрЃЉрЃўрЃА рЃњрЃљрЃюрЃБрЃџрЃћрЃЉрЃљ рЃАрЃБрЃарЃА. рЃарЃљ рЃЌрЃЦрЃЏрЃљ рЃБрЃюрЃЊрЃљ, рЃљрЃЏрЃљрЃА рЃЏрЃЮрЃДрЃЋрЃћрЃЉрЃљ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃАрЃљрЃ«рЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃў. рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃарЃЮрЃЏ рЃЋрЃЌрЃЦрЃЋрЃљ, рЃћрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃљ `eax`-рЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃўрЃЌ рЃЏрЃљрЃюрЃўрЃърЃБрЃџрЃўрЃарЃћрЃЉрЃА.

рЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃљрЃарЃўрЃА

```asm
cmp ax, 6
```

рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф `eax`-рЃўрЃА рЃЦрЃЋрЃћрЃЊрЃљ 16 рЃЉрЃўрЃбрЃА рЃерЃћрЃљрЃЊрЃљрЃарЃћрЃЉрЃА `6`-рЃА. рЃЏрЃЮрЃЏрЃЊрЃћрЃЋрЃюрЃЮ рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ рЃЌрЃБ рЃћрЃА рЃЊрЃћрЃЉрЃБрЃџрЃћрЃЉрЃљ рЃерЃћрЃАрЃарЃБрЃџрЃЊрЃћрЃЉрЃљ, рЃЏрЃљрЃерЃўрЃю `EIP` рЃарЃћрЃњрЃўрЃАрЃбрЃарЃљрЃбрЃЮрЃарЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ рЃњрЃљрЃ«рЃЊрЃћрЃЉрЃљ `0x4033df` рЃарЃљрЃф рЃюрЃўрЃерЃюрЃљрЃЋрЃА рЃўрЃЏрЃљрЃА, рЃарЃЮрЃЏ `CPU` рЃљрЃЏ рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃАрЃљрЃЏрЃљрЃарЃЌрЃўрЃЊрЃљрЃю рЃњрЃљрЃюрЃљрЃњрЃарЃФрЃЮрЃЉрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃарЃБрЃџрЃћрЃЉрЃљрЃА: `0x4033df`.

рЃЌрЃБ рЃћрЃА рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў рЃЏрЃЮрЃ«рЃћрЃарЃ«рЃЊрЃљ, рЃЏрЃљрЃерЃўрЃю `0x00406624` рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃАрЃљрЃЏрЃљрЃарЃЌрЃќрЃћ рЃЏрЃДрЃЮрЃцрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃљрЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃЊрЃћрЃЉрЃљ. рЃЌрЃБ рЃћрЃА рЃљрЃа рЃЏрЃЮрЃ«рЃЊрЃљ, рЃЏрЃљрЃерЃўрЃю `ebx`-рЃўрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ рЃерЃћрЃЋрЃљ рЃАрЃбрЃљрЃЎрЃќрЃћ, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃљрЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃЊрЃћрЃЉрЃљ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃарЃўрЃА `0x00406694` рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃАрЃљрЃЏрЃљрЃарЃЌрЃќрЃћ рЃЏрЃЊрЃћрЃЉрЃљрЃарЃћрЃЮрЃЉрЃА.

## рЃњрЃљрЃњрЃарЃФрЃћрЃџрЃћрЃЉрЃљ

рЃўрЃЏрЃўрЃА рЃњрЃљрЃЏрЃЮ, рЃарЃЮрЃЏ рЃЋрЃўрЃарЃБрЃАрЃў рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊрЃўрЃљ, рЃљрЃЏ рЃћрЃбрЃљрЃърЃќрЃћ рЃЋрЃћрЃа рЃЋрЃљрЃ«рЃћрЃарЃ«рЃћрЃЉ рЃЏрЃўрЃА рЃАрЃарЃБрЃџ рЃљрЃюрЃљрЃџрЃўрЃќрЃА. рЃюрЃћрЃџ-рЃюрЃћрЃџрЃљ рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃћрЃЉрЃА рЃљрЃЏ рЃЏрЃљрЃЋрЃюрЃћ рЃЎрЃЮрЃЊрЃўрЃА рЃерЃћрЃАрЃљрЃ«рЃћрЃЉ. рЃЏрЃћрЃЮрЃарЃћ рЃюрЃљрЃгрЃўрЃџрЃўрЃф рЃЏрЃљрЃџрЃћрЃЋрЃћ рЃњрЃљрЃЏрЃЮрЃЋрЃљ.

**P.S.** рЃљрЃАрЃћрЃЋрЃћ рЃЋрЃбрЃЮрЃЋрЃћрЃЉ рЃЏрЃљрЃЋрЃюрЃћ рЃЎрЃЮрЃЊрЃА, рЃўрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃЌрЃБ рЃЌрЃљрЃЋрЃљрЃЊрЃљрЃф рЃАрЃБрЃарЃА рЃЋрЃўрЃюрЃЏрЃћрЃА рЃЏрЃўрЃАрЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў. `*.zip` рЃцрЃљрЃўрЃџрЃўрЃА рЃърЃљрЃарЃЮрЃџрЃў рЃљрЃарЃўрЃА `infected`. рЃЋрЃўрЃюрЃф рЃљрЃа рЃўрЃфрЃўрЃА рЃЋрЃўрЃарЃБрЃАрЃўрЃА рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮ рЃњрЃљрЃарЃћрЃЏрЃЮрЃерЃў рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃўрЃАрЃћ, рЃарЃЮрЃЏ рЃАрЃљрЃЎрЃБрЃЌрЃљрЃа рЃЌрЃљрЃЋрЃА рЃЊрЃљ рЃАрЃ«рЃЋрЃћрЃЉрЃА рЃќрЃўрЃљрЃюрЃў рЃљрЃа рЃЏрЃўрЃљрЃДрЃћрЃюрЃЮрЃА, рЃюрЃБ рЃерЃћрЃћрЃ«рЃћрЃЉрЃљ рЃцрЃљрЃўрЃџрЃА!
